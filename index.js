// const LinkedList = require('./ds/LinkedList');
// console.log("Link List demo");
// let myLL= new LinkedList().print("create()");
// myLL.append(10).print("append(10)");
// myLL.reverse().print("reverse()");
// myLL.append(5).print("append(5)");
// myLL.append(16).print("append(16)");
// myLL.reverse().print("reverse()");
// myLL.prepend(1).print("prepend(1)");
// myLL.reverse().print("reverse()");
// myLL.insert(2, 99).print("insert(2, 99)");
// myLL.insert(0, 11).print("insert(0, 11)");
// myLL.insert(6, 17).print("insert(6, 17)");
// myLL.remove(0).print("remove(0)");
// myLL.remove(2).print("remove(2)");
// myLL.remove(6);
// myLL.print("remove(6)");
// myLL.remove(4).print("remove(4)");
// myLL.reverse().print("reverse()");

//const DoublyLinkedList = require('./ds/DoublyLinkedList');
// console.log("\n\nDoubly Link List demo");
// let myDLL= new DoublyLinkedList().print("create()");
// myDLL.append(10).print("append(10)");
// myDLL.reverse().print("reverse()");
// myDLL.append(5).print("append(5)");
// myDLL.append(16).print("append(16)");
// myDLL.reverse().print("reverse()");
// myDLL.prepend(1).print("prepend(1)");
// myDLL.reverse().print("reverse()");
// myDLL.insert(2, 99).print("insert(2, 99)");
// myDLL.insert(0, 11).print("insert(0, 11)");
// myDLL.insert(6, 17).print("insert(6, 17)");
// myDLL.remove(0).print("remove(0)");
// myDLL.remove(2).print("remove(2)");
// myDLL.remove(6);
// myDLL.print("remove(6)");
// myDLL.remove(4).print("remove(4)");


// const StackLL = require('./ds/StackLL');
// console.log("\n\nStack Linked List demo");
// let myStackLL = new StackLL();
// myStackLL.print("create()");
// myStackLL.print("peek() = " + myStackLL.peek());
// myStackLL.print("pop() = " + myStackLL.pop());
// myStackLL.push(10).print("push(10)");
// myStackLL.push(15).print("push(15)");
// myStackLL.push(20).print("push(20)");
// myStackLL.print("pop() = " + myStackLL.pop());
// myStackLL.print("peek() = " + myStackLL.peek());
// myStackLL.print("pop() = " + myStackLL.pop());
// myStackLL.print("pop() = " + myStackLL.pop());
// myStackLL.print("isEmpty()= " + myStackLL.isEmpty());

// const Stack = require('./ds/Stack');
// console.log("\n\nStack demo");
// let myStack = new Stack();
// myStack.print("create()");
// myStack.print("peek() = " + myStack.peek());
// myStack.print("pop() = " + myStack.pop());
// myStack.push(10).print("push(10)");
// myStack.push(15).print("push(15)");
// myStack.push(20).print("push(20)");
// myStack.print("pop() = " + myStack.pop());
// myStack.print("peek() = " + myStack.peek());
// myStack.print("pop() = " + myStack.pop());
// myStack.print("pop() = " + myStack.pop());
// myStack.print("isEmpty()= " + myStack.isEmpty());

// const StackArray = require('./ds/StackArray');
// console.log("\n\nStack Array demo");
// let myStackArr = new StackArray();
// myStackArr.print("create()");
// myStackArr.print("peek() = " + myStackArr.peek());
// myStackArr.print("pop() = " + myStackArr.pop());
// myStackArr.push(10).print("push(10)");
// myStackArr.push(15).print("push(15)");
// myStackArr.push(20).print("push(20)");
// myStackArr.print("pop() = " + myStackArr.pop());
// myStackArr.print("peek() = " + myStackArr.peek());
// myStackArr.print("pop() = " + myStackArr.pop());
// myStackArr.print("pop() = " + myStackArr.pop());
// myStackArr.print("isEmpty()= " + myStackArr.isEmpty());

//const QueueLL = require('./ds/QueueLL');
// console.log("\n\nQueue Linked List demo");
// let myQueueLL = new QueueLL();
// myQueueLL.print("create()");
// myQueueLL.print("peek() = " + myQueueLL.peek());
// myQueueLL.print("dequeue()= " + myQueueLL.dequeue());
// myQueueLL.enqueue(10).print("enqueue(10)");
// myQueueLL.enqueue(15).print("enqueue(15)");
// myQueueLL.enqueue(20).print("enqueue(20)");
// myQueueLL.print("dequeue()= " + myQueueLL.dequeue());
// myQueueLL.print("peek() = " + myQueueLL.peek());
// myQueueLL.print("dequeue()= " + myQueueLL.dequeue());
// myQueueLL.print("dequeue()= " + myQueueLL.dequeue());
// myQueueLL.print("dequeue()= " + myQueueLL.dequeue());

// const Queue = require('./ds/Queue');
// console.log("\n\nQueue demo");
// let myQueue = new Queue();
// myQueue.print("create()");
// myQueue.print("peek() = " + myQueue.peek());
// myQueue.print("dequeue()= " + myQueue.dequeue());
// myQueue.enqueue(10).print("enqueue(10)");
// myQueue.enqueue(15).print("enqueue(15)");
// myQueue.enqueue(20).print("enqueue(20)");
// myQueue.print("dequeue()= " + myQueue.dequeue());
// myQueue.print("peek() = " + myQueue.peek());
// myQueue.print("dequeue()= " + myQueue.dequeue());
// myQueue.print("dequeue()= " + myQueue.dequeue());
// myQueue.print("dequeue()= " + myQueue.dequeue());

// const QueueStack = require('./ds/QueueStack');
// console.log("\n\nQueue Stack demo");
// let myQueue = new QueueStack();
// myQueue.print("create()");
// myQueue.print("peek() = " + myQueue.peek());
// myQueue.print("dequeue()= " + myQueue.dequeue());
// myQueue.enqueue(10).print("enqueue(10)");
// myQueue.enqueue(15).print("enqueue(15)");
// myQueue.enqueue(20).print("enqueue(20)");
// myQueue.print("dequeue()= " + myQueue.dequeue());
// myQueue.print("peek() = " + myQueue.peek());
// myQueue.print("dequeue()= " + myQueue.dequeue());
// myQueue.print("dequeue()= " + myQueue.dequeue());
// myQueue.print("dequeue()= " + myQueue.dequeue());

// const CustomArray = require('./ds/Array');
// console.log('\n\nArray demo');
// let myArray = new CustomArray();
// console.log(myArray.get(0));
// console.log(myArray.push(1));
// console.log(myArray);

// const HashTable = require('./ds/HashTable');
// console.log('\n\nHash Table demo');
// let myHashTable = new HashTable(2);
// myHashTable.set('grapes', 10000);
// myHashTable.print();
// myHashTable.set('apples', 54);
// myHashTable.print();
// myHashTable.set('potatoes', 78);
// myHashTable.print();
// console.log(myHashTable.get('grapes'));
// console.log(myHashTable.keys());

// const HashTableLL = require('./ds/HashTableLL');
// console.log('\n\nHash Table Linked List demo');
// let myHashTableLL = new HashTableLL(50);
// myHashTableLL.set('grapes', 10000);
// myHashTableLL.print();
// myHashTableLL.set('apples', 54);
// myHashTableLL.print();
// myHashTableLL.set('potatoes', 78);
// myHashTableLL.print();
// console.log(myHashTableLL.get('grapes'));
// console.log(myHashTableLL.keys());


// const HashTable = require('./ds/HashTable');
// function firstRecurringCharacter(input) {
//   const counts = new HashTable(10);
//   for (let i = 0; i < input.length; i++) {
//     let number = input[i];
//     if (counts.get(number)) {
//       return number;
//     }
//     counts.set(number, 1);
//   }
//   return null;
// }

// console.log(firstRecurringCharacter([2,5, 1,2, 3, 5, 1, 2, 3]));

// const BinaryHeap = require('./ds/BinaryHeap');
// let myMaxHeap = new BinaryHeap(true);
// myMaxHeap.add(3).print("+3");
// myMaxHeap.add(2).print("+2");
// myMaxHeap.add(5).print("+5");
// myMaxHeap.add(1).print("+1");
// myMaxHeap.add(6).print("+6");
// myMaxHeap.add(10).print("+10");
// myMaxHeap.add(15).print("+15");
// console.log("peek", myMaxHeap.peek());
// console.log("ext", myMaxHeap.extract())
// myMaxHeap.print("final");

// const BinaryHeap = require('./ds/BinaryHeap');
// let myMinHeap = new BinaryHeap(false);
// myMinHeap.add(3).print("+3");
// myMinHeap.add(2).print("+2");
// myMinHeap.add(5).print("+5");
// myMinHeap.add(1).print("+1");
// myMinHeap.add(6).print("+6");
// myMinHeap.add(10).print("+10");
// myMinHeap.add(15).print("+15");
// console.log("peek", myMinHeap.peek());
// console.log("ext", myMinHeap.extract())
// myMinHeap.print("final");


const BinaryHeap = require('./ds/BinaryHeap');
const minHeap = new BinaryHeap(false);
const maxHeap = new BinaryHeap(true);
function runningMedian(a) {
  const result = [];
  
  for (let i = 0; i< a.length; i++) {
    if(i===0) {
      minHeap.add(a[i]);
    } else {
      if (a[i] <= median()) {
        maxHeap.add(a[i]);
      } else {
        minHeap.add(a[i]);
      }
    }
    fixChaos();
    let m = median();
    result.push(format(m));
    console.log(a[i]);
    maxHeap.print("Max");
    minHeap.print("Min");
  }
  return result;
}

function fixChaos(){
  //if sizes of heaps differ by 2, then it's a chaos, since median must be the middle element
  if( Math.abs(maxHeap.size() - minHeap.size()) > 1) {
      //check which one is the culprit and take action by kicking out the root from culprit into victim
      if(maxHeap.size() > minHeap.size()){
          minHeap.add(maxHeap.extract());
      }
      else{ maxHeap.add(minHeap.extract());}
  }
}

function median() {
  if( maxHeap.size() === minHeap.size()) {
    return (maxHeap.peek() + minHeap.peek())/2 ;
  }
  else if (maxHeap.size() > minHeap.size())
  { 
    return maxHeap.peek();
  }
  else { 
    return minHeap.peek();
  }
}

function format(num) {
  return (Math.round(parseFloat(num) * 10)/10).toFixed(1);
}



let result = runningMedian([1, 2, 3, 4, 5, 6, 7, 8, 9, 10]);
console.log(result);